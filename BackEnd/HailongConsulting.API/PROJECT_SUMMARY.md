# æµ·éš†å’¨è¯¢APIé¡¹ç›®æ€»ç»“

## ğŸ“¦ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯æµ·éš†å’¨è¯¢å®˜ç½‘çš„åç«¯APIæœåŠ¡ï¼ŒåŸºäº .NET 7 Web API æ„å»ºï¼Œé‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œæä¾›å®Œæ•´çš„RESTful APIæ¥å£ã€‚

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

### åˆ†å±‚ç»“æ„

```
HailongConsulting.API/
â”‚
â”œâ”€â”€ Controllers/              # æ§åˆ¶å™¨å±‚ - APIç«¯ç‚¹
â”‚   â”œâ”€â”€ AuthController.cs    # è®¤è¯ç›¸å…³API
â”‚   â””â”€â”€ ProjectsController.cs # é¡¹ç›®ç®¡ç†API
â”‚
â”œâ”€â”€ Services/                 # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ IAuthService.cs      # è®¤è¯æœåŠ¡æ¥å£
â”‚   â”œâ”€â”€ AuthService.cs       # è®¤è¯æœåŠ¡å®ç°
â”‚   â”œâ”€â”€ IProjectService.cs   # é¡¹ç›®æœåŠ¡æ¥å£
â”‚   â””â”€â”€ ProjectService.cs    # é¡¹ç›®æœåŠ¡å®ç°
â”‚
â”œâ”€â”€ Repositories/             # æ•°æ®è®¿é—®å±‚
â”‚   â”œâ”€â”€ IRepository.cs       # é€šç”¨ä»“å‚¨æ¥å£
â”‚   â”œâ”€â”€ Repository.cs        # é€šç”¨ä»“å‚¨å®ç°
â”‚   â”œâ”€â”€ IUnitOfWork.cs       # å·¥ä½œå•å…ƒæ¥å£
â”‚   â””â”€â”€ UnitOfWork.cs        # å·¥ä½œå•å…ƒå®ç°
â”‚
â”œâ”€â”€ Models/                   # æ•°æ®æ¨¡å‹å±‚
â”‚   â”œâ”€â”€ Entities/            # æ•°æ®åº“å®ä½“
â”‚   â”‚   â”œâ”€â”€ User.cs
â”‚   â”‚   â”œâ”€â”€ Project.cs
â”‚   â”‚   â”œâ”€â”€ Client.cs
â”‚   â”‚   â””â”€â”€ Category.cs
â”‚   â”œâ”€â”€ DTOs/                # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚   â”œâ”€â”€ LoginDto.cs
â”‚   â”‚   â””â”€â”€ ProjectDto.cs
â”‚   â””â”€â”€ ViewModels/          # è§†å›¾æ¨¡å‹
â”‚       â””â”€â”€ ProjectQueryViewModel.cs
â”‚
â”œâ”€â”€ Data/                     # æ•°æ®ä¸Šä¸‹æ–‡
â”‚   â””â”€â”€ ApplicationDbContext.cs
â”‚
â”œâ”€â”€ Common/                   # å…¬å…±ç»„ä»¶
â”‚   â”œâ”€â”€ ApiResponse.cs       # ç»Ÿä¸€å“åº”æ ¼å¼
â”‚   â”œâ”€â”€ PagedResult.cs       # åˆ†é¡µç»“æœ
â”‚   â”œâ”€â”€ MappingProfile.cs    # AutoMapperé…ç½®
â”‚   â””â”€â”€ Helpers/             # å·¥å…·ç±»
â”‚       â”œâ”€â”€ JwtHelper.cs     # JWTå¸®åŠ©ç±»
â”‚       â””â”€â”€ PasswordHelper.cs # å¯†ç å¸®åŠ©ç±»
â”‚
â”œâ”€â”€ Middleware/               # ä¸­é—´ä»¶
â”‚   â””â”€â”€ ExceptionHandlingMiddleware.cs # å…¨å±€å¼‚å¸¸å¤„ç†
â”‚
â”œâ”€â”€ Program.cs                # åº”ç”¨ç¨‹åºå…¥å£
â”œâ”€â”€ appsettings.json         # é…ç½®æ–‡ä»¶
â””â”€â”€ appsettings.Development.json # å¼€å‘ç¯å¢ƒé…ç½®
```

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### 1. èº«ä»½è®¤è¯ä¸æˆæƒ
- âœ… JWT Tokenè®¤è¯
- âœ… åŸºäºè§’è‰²çš„æˆæƒï¼ˆAdmin, Manager, Userï¼‰
- âœ… å¯†ç åŠ å¯†å­˜å‚¨ï¼ˆSHA256ï¼‰
- âœ… Tokenè¿‡æœŸç®¡ç†
- âœ… å¯†ç ä¿®æ”¹åŠŸèƒ½

### 2. é¡¹ç›®ç®¡ç†
- âœ… é¡¹ç›®CRUDæ“ä½œ
- âœ… åˆ†é¡µæŸ¥è¯¢
- âœ… å¤šæ¡ä»¶ç­›é€‰
- âœ… æ’åºåŠŸèƒ½
- âœ… æµè§ˆæ¬¡æ•°ç»Ÿè®¡
- âœ… å…³è”æŸ¥è¯¢ï¼ˆå®¢æˆ·ã€åˆ†ç±»ã€é¡¹ç›®ç»ç†ï¼‰

### 3. ç»Ÿä¸€å“åº”æ ¼å¼
```json
{
  "success": true,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {},
  "timestamp": "2025-12-03T10:00:00"
}
```

### 4. åˆ†é¡µæ”¯æŒ
```json
{
  "pageIndex": 1,
  "pageSize": 10,
  "totalCount": 100,
  "totalPages": 10,
  "hasPreviousPage": false,
  "hasNextPage": true,
  "items": []
}
```

### 5. å…¨å±€å¼‚å¸¸å¤„ç†
- âœ… ç»Ÿä¸€å¼‚å¸¸æ•è·
- âœ… å‹å¥½é”™è¯¯ä¿¡æ¯
- âœ… è¯¦ç»†æ—¥å¿—è®°å½•

### 6. æ—¥å¿—è®°å½•
- âœ… Serilogç»“æ„åŒ–æ—¥å¿—
- âœ… æ§åˆ¶å°è¾“å‡º
- âœ… æ–‡ä»¶æŒä¹…åŒ–
- âœ… æŒ‰æ—¥æœŸæ»šåŠ¨

### 7. APIæ–‡æ¡£
- âœ… Swagger UI
- âœ… OpenAPIè§„èŒƒ
- âœ… åœ¨çº¿æµ‹è¯•
- âœ… JWTè®¤è¯é›†æˆ

## ğŸ”§ æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| .NET | 7.0 | åº”ç”¨æ¡†æ¶ |
| Entity Framework Core | 7.0.14 | ORMæ¡†æ¶ |
| MySQL | 8.0+ | æ•°æ®åº“ |
| JWT | 7.0.3 | èº«ä»½è®¤è¯ |
| AutoMapper | 12.0.1 | å¯¹è±¡æ˜ å°„ |
| Serilog | 7.0.0 | æ—¥å¿—è®°å½• |
| Swagger | 6.5.0 | APIæ–‡æ¡£ |

## ğŸ“‹ APIç«¯ç‚¹æ¸…å•

### è®¤è¯ç›¸å…³
| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ | è®¤è¯ |
|------|------|------|------|
| POST | /api/auth/login | ç”¨æˆ·ç™»å½• | âŒ |
| POST | /api/auth/change-password | ä¿®æ”¹å¯†ç  | âœ… |
| POST | /api/auth/validate-token | éªŒè¯Token | âŒ |

### é¡¹ç›®ç®¡ç†
| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ | è®¤è¯ | è§’è‰² |
|------|------|------|------|------|
| GET | /api/projects | è·å–é¡¹ç›®åˆ—è¡¨ | âŒ | - |
| GET | /api/projects/{id} | è·å–é¡¹ç›®è¯¦æƒ… | âŒ | - |
| POST | /api/projects | åˆ›å»ºé¡¹ç›® | âœ… | Admin, Manager |
| PUT | /api/projects/{id} | æ›´æ–°é¡¹ç›® | âœ… | Admin, Manager |
| DELETE | /api/projects/{id} | åˆ é™¤é¡¹ç›® | âœ… | Admin |

## ğŸ¯ è®¾è®¡æ¨¡å¼

### 1. ä»“å‚¨æ¨¡å¼ï¼ˆRepository Patternï¼‰
- æŠ½è±¡æ•°æ®è®¿é—®é€»è¾‘
- æä¾›ç»Ÿä¸€çš„æ•°æ®æ“ä½œæ¥å£
- æ”¯æŒå•å…ƒæµ‹è¯•

### 2. å·¥ä½œå•å…ƒæ¨¡å¼ï¼ˆUnit of Workï¼‰
- ç®¡ç†äº‹åŠ¡
- åè°ƒå¤šä¸ªä»“å‚¨
- ç¡®ä¿æ•°æ®ä¸€è‡´æ€§

### 3. ä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼‰
- æ¾è€¦åˆè®¾è®¡
- ä¾¿äºæµ‹è¯•å’Œç»´æŠ¤
- ASP.NET Coreå†…ç½®æ”¯æŒ

### 4. DTOæ¨¡å¼ï¼ˆData Transfer Objectï¼‰
- åˆ†ç¦»å†…éƒ¨å®ä½“å’Œå¤–éƒ¨æ¥å£
- æ§åˆ¶æ•°æ®ä¼ è¾“
- æé«˜å®‰å…¨æ€§

## ğŸ” å®‰å…¨ç‰¹æ€§

### 1. è®¤è¯å®‰å…¨
- JWT Tokenè®¤è¯
- Tokenè¿‡æœŸæœºåˆ¶
- å¯†ç SHA256åŠ å¯†

### 2. æˆæƒæ§åˆ¶
- åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰
- ç»†ç²’åº¦æƒé™ç®¡ç†
- APIçº§åˆ«çš„æˆæƒæ£€æŸ¥

### 3. æ•°æ®å®‰å…¨
- SQLæ³¨å…¥é˜²æŠ¤ï¼ˆEF Coreå‚æ•°åŒ–æŸ¥è¯¢ï¼‰
- XSSé˜²æŠ¤ï¼ˆè¾“å…¥éªŒè¯ï¼‰
- CORSé…ç½®

### 4. æ—¥å¿—å®‰å…¨
- æ•æ„Ÿä¿¡æ¯è„±æ•
- è¯¦ç»†çš„å®¡è®¡æ—¥å¿—
- é”™è¯¯è¿½è¸ª

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. æ•°æ®åº“ä¼˜åŒ–
- ç´¢å¼•ä¼˜åŒ–ï¼ˆç”¨æˆ·åã€é‚®ç®±ã€é¡¹ç›®ä»£ç ç­‰ï¼‰
- è¿æ¥æ± ç®¡ç†
- å¼‚æ­¥æŸ¥è¯¢

### 2. æŸ¥è¯¢ä¼˜åŒ–
- åˆ†é¡µæŸ¥è¯¢å‡å°‘æ•°æ®ä¼ è¾“
- Includeä¼˜åŒ–å…³è”æŸ¥è¯¢
- é¿å…N+1æŸ¥è¯¢é—®é¢˜

### 3. ç¼“å­˜ç­–ç•¥
- å“åº”ç¼“å­˜ï¼ˆå¯é€‰ï¼‰
- åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆå¯æ‰©å±•ï¼‰

## ğŸ§ª æµ‹è¯•å»ºè®®

### å•å…ƒæµ‹è¯•
```csharp
// æµ‹è¯•æœåŠ¡å±‚
[Fact]
public async Task Login_ValidCredentials_ReturnsToken()
{
    // Arrange
    var authService = new AuthService(...);
    
    // Act
    var result = await authService.LoginAsync(new LoginDto { ... });
    
    // Assert
    Assert.NotNull(result);
    Assert.NotEmpty(result.Token);
}
```

### é›†æˆæµ‹è¯•
```csharp
// æµ‹è¯•APIç«¯ç‚¹
[Fact]
public async Task GetProjects_ReturnsPagedResult()
{
    // Arrange
    var client = _factory.CreateClient();
    
    // Act
    var response = await client.GetAsync("/api/projects");
    
    // Assert
    response.EnsureSuccessStatusCode();
}
```

## ğŸ“ˆ æ‰©å±•å»ºè®®

### çŸ­æœŸæ‰©å±•
1. âœ… æ·»åŠ å®¢æˆ·ç®¡ç†API
2. âœ… æ·»åŠ åˆ†ç±»ç®¡ç†API
3. âœ… å®ç°æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
4. âœ… æ·»åŠ æ•°æ®å¯¼å‡ºåŠŸèƒ½
5. âœ… å®ç°é‚®ä»¶é€šçŸ¥

### ä¸­æœŸæ‰©å±•
1. âœ… é›†æˆRedisç¼“å­˜
2. âœ… å®ç°æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆRabbitMQï¼‰
3. âœ… æ·»åŠ å…¨æ–‡æœç´¢ï¼ˆElasticsearchï¼‰
4. âœ… å®ç°å®æ—¶é€šçŸ¥ï¼ˆSignalRï¼‰
5. âœ… æ·»åŠ æ•°æ®ç»Ÿè®¡åˆ†æ

### é•¿æœŸæ‰©å±•
1. âœ… å¾®æœåŠ¡æ¶æ„æ”¹é€ 
2. âœ… å®¹å™¨åŒ–éƒ¨ç½²ï¼ˆDocker/Kubernetesï¼‰
3. âœ… CI/CDæµæ°´çº¿
4. âœ… æ€§èƒ½ç›‘æ§ï¼ˆAPMï¼‰
5. âœ… åˆ†å¸ƒå¼è¿½è¸ª

## ğŸ“ å¼€å‘è§„èŒƒ

### ä»£ç è§„èŒƒ
- éµå¾ªC#ç¼–ç è§„èŒƒ
- ä½¿ç”¨æœ‰æ„ä¹‰çš„å‘½å
- æ·»åŠ XMLæ–‡æ¡£æ³¨é‡Š
- ä¿æŒä»£ç ç®€æ´

### Gitæäº¤è§„èŒƒ
```
feat: æ·»åŠ æ–°åŠŸèƒ½
fix: ä¿®å¤bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: ä»£ç é‡æ„
test: æµ‹è¯•ç›¸å…³
chore: æ„å»º/å·¥å…·é“¾æ›´æ–°
```

### APIè®¾è®¡è§„èŒƒ
- RESTfulé£æ ¼
- ä½¿ç”¨HTTPçŠ¶æ€ç 
- ç»Ÿä¸€å“åº”æ ¼å¼
- ç‰ˆæœ¬æ§åˆ¶

## ğŸ“ å­¦ä¹ èµ„æº

### å®˜æ–¹æ–‡æ¡£
- [ASP.NET Coreæ–‡æ¡£](https://docs.microsoft.com/aspnet/core)
- [Entity Framework Coreæ–‡æ¡£](https://docs.microsoft.com/ef/core)
- [JWT.io](https://jwt.io)

### æ¨èé˜…è¯»
- ã€ŠClean Architectureã€‹
- ã€ŠDomain-Driven Designã€‹
- ã€ŠMicroservices Patternsã€‹

## ğŸ“ è”ç³»æ–¹å¼

- **é¡¹ç›®è´Ÿè´£äºº**: æµ·éš†å’¨è¯¢æŠ€æœ¯å›¢é˜Ÿ
- **æŠ€æœ¯æ”¯æŒ**: support@hailong.com
- **æ–‡æ¡£**: æŸ¥çœ‹é¡¹ç›®README.md

## ğŸ“„ è®¸å¯è¯

Copyright Â© 2025 æµ·éš†å’¨è¯¢. All rights reserved.

---

**é¡¹ç›®åˆ›å»ºæ—¥æœŸ**: 2025-12-03  
**æœ€åæ›´æ–°**: 2025-12-03  
**ç‰ˆæœ¬**: 1.0.0